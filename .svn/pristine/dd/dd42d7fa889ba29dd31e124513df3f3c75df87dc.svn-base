<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!-- 새 페이지 만들기용 -->
        <!-- Start::app-content -->
        <div class="main-content app-content">
            <div class="container-fluid">


               <!-- row start -->
               <div class="row">
					<div class="col-xxl-2 col-xl-12">
						<div class="col-xxl-12 col-xl-6">
							<div class="card custom-card">
								<div class="card-header justify-content-between">
									<div class="card-title">환자목록</div>
								</div>
								<div class="card-body" id="waitingList">

								</div>
							</div>
						</div>
					</div>
					<!-- 차트 div  -->
					<div class="col-xxl-10 col-xl-12">
					
					<!-- 차트 상세 -->
					<div id="chartView">
						<div class="row" style="background-color: white; border-radius: 1%;">
							<div class="col-xl-3" style="border-right: solid 1px rgb(229, 228, 228);">
								<div class="row">
									<div class="col-xl-12">
										<div class="card custom-card">
											<div class="card-header">
												<div class="card-title">
													사전 검사 조회
												</div>
											</div>
											<div class="card-body" id="preInspectionInfo">
												
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-xl-6">
								<div class="col-xl-12">
										<div class="card custom-card">
											<div class="card-header">
												<div class="card-title">
													사전 검사 등록
												</div>
											</div>
											<div class="card-body" id="preInspectionInfo">
												<input type="hidden" id="hsptlzNoInp" name="hsptlzNo" />
												혈액 : <input type="text" class="form-control" name="inspctBlood"/>
												심전도 : <input type="text" class="form-control" name="inspctElecgrm"/>
												소변검사 : <input type="text" class="form-control" name="inspctUrine"/>
												비고 : <input type="text" class="form-control" name="inspctDescription"/>
												검사일시 : <input type="text" class="form-control" name="inspctDate"/>
												<input type="hidden" class="form-control" name="empNoz"/>
												<button type="button" class="btn btn-info" id="insertPreInspection">작성</button>
											</div>
										</div>
									</div>
							</div>
							<div class="col-xl-3"
								style="border-left: solid 1px rgb(229, 228, 228);">
								<div class="row">
									<div class="col-xxl-12 col-xl-12">
										<div class="row">
											<div class="col-xl-12 col-xl-6">
												<div
													class="col-xxl-12 col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
													<div class="card custom-card">
														<div class="card-header justify-content-between">
															<div class="card-title">검사결과</div>
															<div class="dropdown">
																<a href="javascript:void(0);"
																	class="p-2 fs-12 text-muted" data-bs-toggle="dropdown"
																	aria-expanded="false"> View All<i
																	class="ri-arrow-down-s-line align-middle ms-1 d-inline-block"></i>
																</a>
																<ul class="dropdown-menu" role="menu">
																	<li><a class="dropdown-item"
																		href="javascript:void(0);">Today</a></li>
																	<li><a class="dropdown-item"
																		href="javascript:void(0);">This Week</a></li>
																	<li><a class="dropdown-item"
																		href="javascript:void(0);">Last Week</a></li>
																</ul>
															</div>
														</div>
														<div class="card-body">
															<ul class="list-unstyled">
																<!-- list-unstyled 클래스 추가 -->
																<div>────────2024.03.03.───────</div>
																<br />
																<li class="mail-type"><a href="javascript:void(0);">

																		<div>
																			<div class="d-flex align-items-center">
																				<span class="me-2 lh-1"> <i
																					class="ri-inbox-archive-line align-middle fs-14"></i>
																				</span> <span class="flex-fill text-nowrap">
																					Rf.foot,lateral,oblique view </span><br>
																			</div>
																</a></li>
																<br />
																<li class="mail-type"><a href="javascript:void(0);">

																		<div>
																			<div class="d-flex align-items-center">
																				<span class="me-2 lh-1"> <i
																					class="ri-inbox-archive-line align-middle fs-14"></i>
																				</span> <span class="flex-fill text-nowrap">
																					Rf.ancle,lateral,oblique view </span><br>
																			</div>
																</a></li>
															</ul>

															<div>
																<button type="button" class="btn btn-outline-info rounded-pill btn-wave" id="requestRadiationBtn" data-bs-toggle="modal" data-bs-target="#requestRadiationModal" style="float: right;">검사요청</button>
															</div>
														</div>
													</div>
												</div>
												
												
												
												<div class="card custom-card" style="border: solid 1px rgb(229, 228, 228); margin-bottom: 0%">
													<div class="card-header justify-content-between">
														<div class="card-title">오더세트</div>
														<div class="dropdown">
															<a aria-label="anchor" href="javascript:void(0);"
																class="btn btn-icon btn-sm btn-light"
																data-bs-toggle="dropdown"> <i
																class="fe fe-more-vertical"></i>
															</a>
															<ul class="dropdown-menu">
																<li><a class="dropdown-item"
																	href="javascript:void(0);">추가</a></li>
																<li><a class="dropdown-item"
																	href="javascript:void(0);">수정</a></li>
															</ul>
														</div>
													</div>
													<div class="card-body">
															<ul class="main-menu" style="margn-left:5px">
																<li class="slide has-sub">
																	<a href="javascript:void(0);" class="side-menu__item">
																		<i class="ti ti-file-text"></i> 
																			<span class="side-menu__label">골절</span> 
																			<i class="fe fe-chevron-right side-menu__angle">
																		</i>
																	</a>
																</li>
																<li class="slide has-sub">
																	<a href="javascript:void(0);" class="side-menu__item">
																		<i class="ti ti-file-text"></i> 
																			<span class="side-menu__label">허리디스크</span> 
																			<i class="fe fe-chevron-right side-menu__angle">
																		</i>
																	</a>
																</li>
															</ul>
													</div>
												</div>
												<div class="card custom-card" style="border: solid 1px rgb(229, 228, 228); margin-top: 0px;">
                                                    <div class="card-header justify-content-between">
                                                        <h7 class="fw-semibold">허리디스크</h7>
                                                        <div>
                                                            <a href="">
                                                                <i class="bi bi-plus-square float-end text-secondary fs-18"></i>
                                                            </a>
                                                        </div>
                                                    </div>
                                                    <div class="card-body">
                                                        <ul class="main-menu" style="list-style-type: none; padding: 0; margin: 0;">
                                                            <li><i class='bx bx-plus-medical'></i>관절통</li>
                                                            <li>
                                                           <svg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='currentColor' class='bi bi-capsule' viewBox='0 0 16 16'>
                                                            <path d='M1.828 8.9 8.9 1.827a4 4 0 1 1 5.657 5.657l-7.07 7.071A4 4 0 1 1 1.827 8.9Zm9.128.771 2.893-2.893a3 3 0 1 0-4.243-4.242L6.713 5.429z'/>
                                                            </svg> 에포리스정</li>
                                                        </ul>
                                                    </div>
                                                </div>
											</div>

										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					</div>
				</div>
               <!-- row end -->

            </div>
        </div>
        <!-- End::app-content -->

        <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModal" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-body">
                  <div class="input-group">
                    <a href="javascript:void(0);" class="input-group-text" id="Search-Grid"><i class="fe fe-search header-link-icon fs-18"></i></a>
                    <input type="search" class="form-control border-0 px-2" placeholder="Search" aria-label="Username">
                    <a href="javascript:void(0);" class="input-group-text" id="voice-search"><i class="fe fe-mic header-link-icon"></i></a>
                    <a href="javascript:void(0);" class="btn btn-light btn-icon" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="fe fe-more-vertical"></i>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="javascript:void(0);">Action</a></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Another action</a></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Something else here</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Separated link</a></li>
                    </ul>
                  </div>
                  <div class="mt-4">
                    <p class="font-weight-semibold text-muted mb-2">Are You Looking For...</p>
                    <span class="search-tags alert"><i class="fe fe-user me-2"></i>People<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-file-text me-2"></i>Pages<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-align-left me-2"></i>Articles<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-server me-2"></i>Tags<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                  </div>
                  <div class="my-4">
                    <p class="font-weight-semibold text-muted mb-2">Recent Search :</p>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-2 alert">
                      <a href="notifications.html"><span>Notifications</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-2 alert">
                      <a href="alerts.html"><span>Alerts</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-0 alert">
                      <a href="mail.html"><span>Mail</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <div class="btn-group ms-auto">
                    <button type="button" class="btn btn-sm btn-primary-light">Search</button>
                    <button type="button" class="btn btn-sm btn-primary">Clear Recents</button>
                  </div>
                </div>
              </div>
            </div>
        </div>
       
    
    <!-- Scroll To Top -->
    <div class="scrollToTop">
        <span class="arrow"><i class="ri-arrow-up-s-fill fs-20"></i></span>
    </div>
    <div id="responsive-overlay"></div>
    <!-- Scroll To Top -->

    <!-- Popper JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/libs/@popperjs/core/umd/popper.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Defaultmenu JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/defaultmenu.min.js"></script>

    <!-- Node Waves JS-->
    <script src="${pageContext.request.contextPath }/resources/assets/libs/node-waves/waves.min.js"></script>

    <!-- Sticky JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/sticky.js"></script>

    <!-- Simplebar JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/libs/simplebar/simplebar.min.js"></script>
    <script src="${pageContext.request.contextPath }/resources/assets/js/simplebar.js"></script>

    <!-- Color Picker JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/libs/@simonwep/pickr/pickr.es5.min.js"></script>


    
    <!-- Custom-Switcher JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/custom-switcher.min.js"></script>

    <!-- Internal Product-Details JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/product-list.js"></script>

    <!-- Custom JS -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/custom.js"></script>
    
    <!-- jQuery -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

</body>
<script type="text/javascript">
	$(function() {
		
		$.ajax({
			url : "/nurse/getWaitingSurgeryList",
			type : "post",
			success : function (res) {
				console.log(res);
				let waitingList = $('#waitingList');
				let html = "";
				$.each(res, function(index, item) {
					console.log(item);
					let hsptlzNo = item.hsptlzRecordVO.hsptlzNo;
					let memName = item.memName;
					let memAge = item.memAge;
					let memGender = item.memGender;
					let orderCode = item.orderVO.orderCode;
					// 임시로 해놓음
					html += '<div class="card border custom-card" style="background-color:white;width: 280px;height: 110px;margin-left: 10px;margin-bottom: 10px; margin-top: 5px;">'+
		            '<div class="card-header" style="height: 30px; background-color: #f6feff !important">'+
		            '<span class="fw-semibold fs-13" style="position: absolute; left: 12px; ">수납대기실</span>'+
		            '</div>'+
		            '<div class="card-body p-3" style="width: 240px;height: 110px;margin-left: 10px;margin-bottom: 10px;" data-name="info">'+
		            '<div class="d-flex justify-content-between align-items-start mb-3 flex-wrap" style="">'+
		            '<div class="d-inline-flex align-items-start position-relative">'+
		            // '<a href="profile.html" class="stretched-link"></a>'+
		            '<div class="flex-grow-1">'+
		            '<span class="mb-0 d-block fs-15 fw-semibold pickPt">' + item.memName + '</span>'+
		            '<span class="fs-13 text-muted">' + item.memGender + ' ' + item.memAge + '세</span>'+
		            '</div>' +
		            '</div>' +
		            '<span class="fs-10 badge rounded-pill bg-secondary">수납대기중</span>'+
		            
		            '</div>' +
		            '<input type="hidden" value="'+item.hsptlzRecordVO.hsptlzNo+'" />'+
		            '</div>' +
		            '</div>';
				});
				waitingList.html(html);
			}
			
		});
		
		$(document).on('click', '[data-name="info"]', function() {
			let hsptlzNo = $(this).find('input').val();
			console.log(hsptlzNo);
		    let data = {
		    	hsptlzNo : hsptlzNo
		    }
		    
		    $.ajax({
		    	url : "/nurse/getPreInspectionInfo",
		    	type : "post",
		    	data : JSON.stringify(data),
		    	contentType : "application/json",
		    	success : function(res) {
					console.log(res);
					if (res == null || res == "") {
						// 사전검사 등록되지 않은 환자라고 알리고 등록 할건지 물어보기
						let hsptlzNoInp = $('#hsptlzNoInp');
						hsptlzNoInp.val(hsptlzNo);
					} else {
						// 검사 결과 화면에 추가
					}
				} 
		    });
		});
		
		let insertPreInspectionBtn = $('#insertPreInspection');
		insertPreInspectionBtn.click(function() {
			console.log("insert!!!");
			
			let hsptlzNo = $('input[name=hsptlzNo]').val();
			let inspctBlood = $('input[name=inspctBlood]').val();
			let inspctElecgrm = $('input[name=inspctElecgrm]').val();
			let inspctUrine = $('input[name=inspctUrine]').val();
			let inspctDescription = $('input[name=inspctDescription]').val();
			let inspctDate = $('input[name=inspctDate]').val();
			
			console.log(hsptlzNo);
			console.log(inspctBlood);
			console.log(inspctElecgrm);
			console.log(inspctUrine);
			console.log(inspctDescription);
			console.log(inspctDate);
			
			let data = {
				hsptlzNo : hsptlzNo,
				inspctBlood: inspctBlood,
				inspctElecgrm : inspctElecgrm,
				inspctUrine : inspctUrine,
				inspctDescription : inspctDescription,
				inspctDate : inspctDate
			};
			
			$.ajax({
				url : "/nurse/insertPreInspection",
				type : "post",
				data : JSON.stringify(data),
				contentType : "application/json",
				sueccess : function(res) {
					console.log(res);
				}
			});
		});
	});
</script>

</html>