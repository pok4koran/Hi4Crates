<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<style>
img {
	width: 50px;
	height: auto;
	float: left;
}

.brightness {
	-webkit-filter: brightness(0.50);
	filter: brightness(0.50);
}

.opacity {
	-webkit-filter: opacity(50%);
	filter: opacity(50%);
}
</style>
</head>

<body>




	<!-- 본문 시작 -->
	<!-- Start::app-content -->
	<div class="main-content app-content">
		<div class="container-fluid">

			<!-- Start::row-1 -->
			<div class="row">

				<div class="col-xl-2">
					<div class="row">
						<div class="col-xl-12">
							<div class="card custom-card">

								<div class="card-header">
									<div class="card-title">환자 목록</div>
								</div>

								<div class="card-body p-0">

									<div class="table-responsive">
										<table class="table text-nowrap">
											<div data-simplebar style="overflow-y: auto;">
											
											<!-- forEach 위치 -->
											<c:set value="${pagingVO.dataList }" var="empNoticeList" />
											<c:choose>
												<c:when test="${empty empNoticeList }">
													<tr>
														<td>
															<div class="d-flex align-items-center" onclick="onClick()">
																<div>
																	<div class="card-text text-dark mb-1 fs-14 fw-semibold">김영미 
																		<span class="card-title text-muted fs-11 mb-0">여 / 24세</span>
																	</div>
																	<div class="card-title fs-12 mb-1">6번 침대</div>
																</div>
																<span class="badge bg-danger ms-3 ms-auto">치료중</span>
															</div>
														</td>
													</tr>
												</c:when>
												<c:otherwise>
													<c:forEach items="${empNoticeList }" var="notice" varStatus="status">
														<tr>
															<td>
																<div class="d-flex align-items-center" onclick="onClick()">
																	<div>
																		<div class="card-text text-dark mb-1 fs-14 fw-semibold">김영미 
																			<span class="card-title text-muted fs-11 mb-0">여 / 24세</span>
																		</div>
																		<div class="card-title fs-12 mb-1">6번 침대</div>
																	</div>
																	<span class="badge bg-danger ms-3 ms-auto">치료중</span>
																</div>
															</td>
														</tr>
														<tr>
															<td>
																<div class="d-flex align-items-center" onclick="onClick()">
																	<div>
																		<div class="card-text text-dark mb-1 fs-14 fw-semibold">박정현
																			 <span class="card-title text-muted fs-11 mb-0">여 / 34세</span>
																		</div>
																		<div class="card-title fs-12 mb-1">물리치료 대기실</div>
																	</div>
																	<span class="badge bg-secondary ms-3 ms-auto">대기</span>
																</div>
															</td>
														</tr>
														<tr>
															<td>
																<div class="d-flex align-items-center" onclick="onClick()">
																	<div>
																		<div class="card-text text-dark mb-1 fs-14 fw-semibold">송해랑
																			<span class="card-title text-muted fs-11 mb-0">남 / 17세</span>
																		</div>
																		<div class="card-title fs-12 mb-1">수납 대기</div>
																	</div>
																	<span class="badge bg-success ms-3 ms-auto">치료완료</span>
																</div>
															</td>
														</tr>
													</c:forEach>
												</c:otherwise>
											</c:choose>
											</div>
										</table>
									</div>
								</div>
								<div class="card-footer">
									<span class="card-title text-muted fs-11 mb-0">
										환자 검색 조건: <br>
										LOC013	물리치료대기실<br>
										LOC008	물리치료실1<br>
										HS001	대기중<br>
										HS003	치료중<br>
										LOC012	수납대기실
									</span>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="col-xl-4">

					<div class="card custom-card" style="height: 37vh;">
						<div class="card-header">
							<div class="card-title">오더 조회</div>
						</div>
						<div class="card-body" data-simplebar style="overflow-y: auto;">
							좌측 대기환자 리스트에서 클릭시 해당 환자의 order출력 <br> 차트번호 이용해 리스트로 오더 불러오기<br>
							상태코드, 사용중 코드 활용<br>
						</div>
					</div>

					<div class="row-xl-3">
						<div class="card custom-card" style="height: 37vh;">
							<div class="card-header">
								<div class="card-title">치료세팅</div>
							</div>
							<div class="card-body" style="overflow-y: auto;">
								<c:choose>
									<c:when test="${empty radiationRoomList }">
										<div>
											<p class="fw-semibold mb-3 d-flex align-items-center">
												<a href="javascript:void(0);"> <!-- 														치료기구 정보가 존재하지 않습니다.<br> -->
													(임시 메모) 치료·부위 복수선택해서 세팅하면 우상단 침상에 셋되고 카운트 시작
												</a>
											</p>
											<br /> <br />
										</div>
									</c:when>
									<c:otherwise>
										<c:forEach items="${radiationRoomList }" var="radiationRoom">
											<div>
												<p class="fw-semibold mb-3 d-flex align-items-center">
													<a href="javascript:void(0);">${radiationRoom.rocName }</a>
												</p>
												<br /> <br />
											</div>
										</c:forEach>
									</c:otherwise>
								</c:choose>
							</div>
						</div>
					</div>
				</div>

				<div class="col-xl-6">
					<div class="row">
						<div class="col-xl-12">
							<div class="card custom-card">
								<div class="card-header d-flex justify-content-between">
									<div class="card-title">환자 배치</div>
								</div>
								<div class="card-body">
									<p>환자 이름, 사용중인 기기, 남은 시간을 어디에 배치할 것인가?</p>
									<p>여기서 버튼 눌러서 치료 마치면 아래 치료기록 입력 준비되도록</p>
									<div class="table-responsive">
										<table class="table text-nowrap table-bordered">
											<tr>
												<td>
													<div class="wrap">
														<!-- 																<div style="position: relative;" onclick="countDown('bed1');"> -->
														<img id="bed1"
															src="/resources/assets/img/bedtime-icon.svg"
															class="brightness opacity">
														<div style="position: absolute;">
															<div id="bedName1"></div>
														</div>
														<!-- 																</div> -->
													</div>
												</td>
												<td>
													<div class="wrap">
														<!-- 																<div style="position: relative;" onclick="countDown('bed2');"> -->
														<img id="bed2"
															src="/resources/assets/img/bedtime-icon.svg"
															class="brightness opacity">
														<!-- 																</div> -->
													</div>
												</td>
												<td>
													<div class="wrap">
														<!-- 																<div style="position: relative;" onclick="countDown('bed3');"> -->
														<img id="bed3"
															src="/resources/assets/img/bedtime-icon.svg"
															class="brightness opacity">
														<!-- 																</div> -->
													</div>
												</td>
											</tr>
											<tr>
												<td>
													<div id="bed1_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
												<td>
													<div id="bed2_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
												<td>
													<div id="bed3_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
											</tr>
											<tr>
												<td>
													<div class="wrap">
														<!-- 																<div style="position: relative;" onclick="countDown('bed4');"> -->
														<img id="bed4"
															src="/resources/assets/img/bedtime-icon.svg"
															class="brightness opacity">
														<!-- 																</div> -->
													</div>
												</td>
												<td>
													<div class="wrap">
														<!-- 																<div style="position: relative;" onclick="countDown('bed5');"> -->
														<img id="bed5"
															src="/resources/assets/img/bedtime-icon.svg"
															class="brightness opacity">
														<!-- 																</div> -->
													</div>
												</td>
												<td>
													<div class="wrap">
														<div style="position: relative;"
															onclick="countDown('bed6');">
															<img id="bed6"
																src="/resources/assets/img/bedtime-icon.svg"
																class="brightness opacity">
														</div>
													</div>
												</td>
											</tr>
											<tr>
												<td>
													<div id="bed4_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
												<td>
													<div id="bed5_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
												<td>
													<div id="bed6_1">
														<span style='color: #808080; font-size: large;'>00:00</span>
													</div>
												</td>
											</tr>
										</table>
									</div>
								</div>
							</div>
						</div>

						<div class="col-xl-12">
							<div class="card custom-card">
								<div class="card-header d-flex justify-content-between">
									<div class="card-title">치료 기록</div>
								</div>
								<div class="card-body">
									<textarea class="form-control" id=""></textarea>

								</div>
								<div class="card-footer">
									<button class="btn btn-info">버튼</button>
								</div>
							</div>
						</div>
					</div>
				</div>

			</div>
			<!--End::row-1 -->





		</div>
	</div>
	<!-- End::app-content -->
	<!--본문 끝-->

</body>
<script type="text/javascript">
	// function countDown(elementId){
	// 	console.log("countDown function 실행..! " + elementId);
	// 	var timer;

	// 	$("#" + elementId).on("click", function(){
	// 		console.log("click 이벤트 인식: " + elementId)
	// 		var image = $("#" + elementId);
	// 		var isBrightness = image.hasClass("brightness");
	// 		var isOpacity = image.hasClass("opacity");
	// 		var bedded = document.getElementById(elementId + "_1");

	// 		if(isBrightness && isOpacity){
	// 			console.log("class 인식: " + elementId)

	// 			clearInterval(timer); // 이미 진행 중인 카운트다운을 멈춤
	// 			image.removeClass("brightness opacity");

	// 			var time = 10;
	// 			timer = setInterval(function(){
	// 				var min = parseInt(time / 60);
	// 				var sec = time % 60;

	// 				bedded.innerHTML =
	// 					"<span style='font-size:large;'>" + 
	// 					min + ":" + sec 
	// 					+ "</span>"
	// 					;
	// 				time--;

	// 				if(time < 0){
	// 					clearInterval(timer);
	// 					image.addClass("brightness opacity");
	// 					bedded.innerHTML = "<span style='color:#808080;font-size:large;'>00:00</span>";
	// 				}
	// 			}, 1000);

	// 		}else{
	// 			console.log("class 없음: " + elementId)
	// 			clearInterval(timer);
	// 			image.addClass("brightness opacity");
	// 			bedded.innerHTML = "<span style='color:#808080;font-size:large;'>00:00</span>";
	// 		}
	// 	});
	// }
</script>
<script type="text/javascript">
	var timer;
	$("#bed1")
			.on(
					"click",
					function() {
						console.log("click 이벤트 인식 ");
						var image = $("#bed1");
						var isBrightness = image.hasClass("brightness");
						var isOpacity = image.hasClass("opacity");
						const bedded1 = document.getElementById('bed1_1');

						var time = 10;
						var min = "";
						var sec = "";
						// 	var isStopped = true;

						if (isBrightness && isOpacity) {
							console.log("class 존재 인식 ");
							clearInterval(timer); // 이미 진행 중인 카운트다운을 멈춤
							image.removeClass("brightness opacity");
							// 		bedded1.innerHTML = "<span style='color:blue;'>추가될 텍스트.</span>";

							var time = 10;
							timer = setInterval(
									function() {
										var min = parseInt(time / 60);
										var sec = time % 60;

										// 				document.getElementById("bed1_1").innerHTML = 
										bedded1.innerHTML =
										// 				"<span style='color:#007AFF;font-size:large;text-shadow: -1px 0px white, 0px 1px white, 1px 0px white, 0px -1px white;'>" + 
										"<span style='font-size:large;'>" + min
												+ ":" + sec + "</span>";
										time--;

										if (time < 0) {
											clearInterval(timer);
											// 				document.getElementById("bed1_1").innerHTML = "0:0";
											image
													.addClass("brightness opacity");
											bedded1.innerHTML = "<span style='color:#808080;font-size:large;'>00:00</span>";
										}
									}, 1000);

						} else {
							console.log("class 없음");
							clearInterval(timer);
							image.addClass("brightness opacity");
							// 		bedded1.innerHTML = "<span style='color:#808080;font-size:large;'>00:00</span>";
						}
					});
</script>
</html>