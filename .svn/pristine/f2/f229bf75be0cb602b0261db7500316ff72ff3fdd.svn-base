<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>
<!DOCTYPE html>
<html lang="en" dir="ltr" data-nav-layout="vertical" data-theme-mode="light" data-header-styles="light" data-menu-styles="dark" data-toggled="close">

<head>

    <!-- Meta Data -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title> YNEX - Bootstrap 5 Premium Admin &amp; Dashboard Template </title>
    <meta name="Description" content="Bootstrap Responsive Admin Web Dashboard HTML5 Template">
    <meta name="Author" content="Spruko Technologies Private Limited">
	<meta name="keywords" content="admin,admin dashboard,admin panel,admin template,bootstrap,clean,dashboard,flat,jquery,modern,responsive,premium admin templates,responsive admin,ui,ui kit.">

   
<!-- Favicon -->
<link rel="icon"
	href="${pageContext.request.contextPath }/resources/assets/images/brand-logos/favicon.ico"
	type="image/x-icon">

<!-- Choices JS -->
<script
	src="${pageContext.request.contextPath }/resources/assets/libs/choices.js/public/assets/scripts/choices.min.js"></script>

<!-- Main Theme Js -->
<script
	src="${pageContext.request.contextPath }/resources/assets/js/main.js"></script>

<!-- Bootstrap Css -->
<link id="style"
	href="${pageContext.request.contextPath }/resources/assets/libs/bootstrap/css/bootstrap.min.css"
	rel="stylesheet">

<!-- Style Css -->
<link
	href="${pageContext.request.contextPath }/resources/assets/css/styles.min.css"
	rel="stylesheet">

<!-- Icons Css -->
<link
	href="${pageContext.request.contextPath }/resources/assets/css/icons.css"
	rel="stylesheet">

<!-- Node Waves Css -->
<link
	href="${pageContext.request.contextPath }/resources/assets/libs/node-waves/waves.min.css"
	rel="stylesheet">

<!-- Simplebar Css -->
<link
	href="${pageContext.request.contextPath }/resources/assets/libs/simplebar/simplebar.min.css"
	rel="stylesheet">

<!-- Color Picker Css -->
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/flatpickr/flatpickr.min.css">
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/@simonwep/pickr/themes/nano.min.css">

<!-- Choices Css -->
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/choices.js/public/assets/styles/choices.min.css">
	
<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/assets/libs/dragula/dragula.min.css">

<!-- <link rel="stylesheet" href="${pageContext.request.contextPath }/resources/assets/libs/jsvectormap/css/jsvectormap.min.css">

<link rel="stylesheet" href="${pageContext.request.contextPath }/resources/assets/libs/swiper/swiper-bundle.min.css"> -->


<!-- Prism CSS -->
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/prismjs/themes/prism-coy.min.css">

<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/filepond/filepond.min.css">
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-preview/filepond-plugin-image-preview.min.css">
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-edit/filepond-plugin-image-edit.min.css">
<link rel="stylesheet"
	href="${pageContext.request.contextPath }/resources/assets/libs/dropzone/dropzone.css">

<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<script src="https://code.jquery.com/jquery-3.7.1.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

<style type="text/css">
.ui-autocomplete {
  max-height: 200px;
  overflow-y: auto;
  /* prevent horizontal scrollbar */
  overflow-x: hidden;
  height: auto;
}

.ui-menu-item div.ui-state-hover,
.ui-menu-item div.ui-state-active {
  color: #ffffff;
  text-decoration: none;
  background-color: #f6B664;
  border-radius: 0px;
  -webkit-border-radius: 0px;
  -moz-border-radius: 0px;
  background-image: none;
  border:none;
}

</style>
</head>

<body>

        <!-- Start::app-content -->
        <div class="main-content app-content">
            <div class="container-fluid">

                <!-- Start::row-1 -->
                <div class="row">
                
                    <div class="col-xxl-10 col-xl-12">
                        <div class="row" style="background-color: white; border-radius: 1%;">
                          <div class="col-xl-3" style="border-right: solid 1px rgb(229, 228, 228);">
                                <div class="col-xl-12">
                                    <div class="card custom-card">
                                        <div class="card-header  justify-content-between">
                                            <div class="card-title">
                                              		 오더세트
                                            </div>
                                            <button class="btn btn-info-ghost btn-wave btn-sm" id="addOrderSet" style="float: right;">
                                                    <i class="ri-add-line me-1 align-middle"></i>추가
                                            </button>
                                        </div>
                                        <div class="card-body" style="max-height: 300px; overflow-y: auto;">
                                            <ul class="dropdown">
		                                        <c:forEach items="${orderSetList }" var="orderSet">
		                                                <li><a class="dropdown-item" href="#" data-groupOrderNo ="${orderSet.groupOrderNo}">${orderSet.groupOrderName}</a></li>
		                                        </c:forEach>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                                
                                <div class="col-xl-6">
                                    <div class="row">
                                        
                                    </div>
                                    <div class="col-xl-12">
                                        <div class="card custom-card">
                                            <div class="card-header justify-content-between">
                                                <div class="card-title">
                                                   	 진단 및 처방
                                                </div>
                                                <div class="">
                                                <!--오더세트 등록 모달 시작-->
                                                <div class="modal fade" id="insert-orderGroup" tabindex="-1" aria-labelledby="insert-orderGroupLabel" aria-hidden="true">
                                                    <div class="modal-dialog modal-dialog-centered">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h6 class="modal-title" id="insert-orderGroupLabel">오더세트 등록</h6>
                                                                <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                                    aria-label="Close"></button>
                                                            </div>
                                                            <div class="modal-body px-4">
                                                                <div class="row gy-3">
                                                                    <div class="col-xl-12">
                                                                        <label for="orderName" class="form-label">오더세트명</label>
                                                                        <input type="text" class="form-control" id="orderName" placeholder="Enter Name">
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn btn-sm btn-light" data-bs-dismiss="modal" id='closeModal'>Cancel</button>
                                                                <button type="button" class="btn btn-sm btn-info" id="createOrderName">Create</button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div> 
                                                <!--오더세트 등록 모달 끝-->
                                            </div>
                                        </div>
                                        <div class="card-body" style="margin-top: -2%;">
                                            <ul class="nav nav-pills nav-style-3" role="tablist">
	                                                <li class="nav-item">
	                                                    <a class="nav-link active" data-bs-toggle="tab" role="tab" aria-current="page"
	                                                    href="#searchDiseases" aria-selected="true">상병</a>
	                                                </li>
	                                                <li class="nav-item">
	                                                    <a class="nav-link" data-bs-toggle="tab" role="tab" aria-current="page"
	                                                    href="#searchMedicine" aria-selected="true">약물</a>
	                                                </li>
	                                            </ul><br/>
												<div class="input-group mb-3" style="margin-top: -2%;">
													<input type="text" class="form-control" placeholder="검색어를 입력하세요" id="searchBox" aria-label="Recipient's username" aria-describedby="button-addon2">
												</div>
												<div class="content-wrapper" style="height: 100px;">
													<div id="crm-revenue-analytics">
														<div class="kanban-tasks-type new">
                                                        <div class="kanban-tasks" id="new-tasks">
                                                            <!-- <span class="badge rounded-pill bg-danger-transparent" style="pointer-events: none;">주상병</span> -->
                                                            <div id="new-tasks-draggable" data-view-btn="new-tasks">
                                                                <span class="badge rounded-pill bg-danger-transparent m-2" id="primaryDisease" style="pointer-events: none;">주상병</span>
                                                            </div>
                                                        </div>
                                                        <div></div>
                                                    </div>
                                                    <div class="kanban-tasks-type todo">
                                                        <div class="kanban-tasks" id="todo-tasks">
                                                            <div id="todo-tasks-draggable" data-view-btn="todo-tasks">
                                                                <span class="badge rounded-pill bg-danger-transparent m-2" style="pointer-events: none;" id="secondDisease">부상병</span><br/>
                                                            </div>
                                                        </div>
                                                    </div>
														<div>
															<span class="badge rounded-pill bg-info-transparent m-2" id="medicinePrescription">처방</span><br/>
														</div>
													</div>
                                                    
                                                    <div class="btn-list">
                                                        <button type="button" class="btn btn-outline-secondary btn-wave btn-sm" data-bs-toggle="modal"
                                                			data-bs-target="#insert-orderGroup" style="float: right;">등록</button>
                                                        <button type="button" class="btn btn-outline-danger btn-wave btn-sm" style="float: right;">삭제</button>
                                                    </div>
                                                    <div>
                                                        <br>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                
                        </div>  
                        </div>
                    </div>
                    <!-- <div class="col-xxl-2 col-xl-12"> -->
                    
                </div>
                <!-- End::row-1 -->

            </div>
        </div>
        <!-- End::app-content -->
        
        <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModal" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-body">
                  <div class="input-group">
                    <a href="javascript:void(0);" class="input-group-text" id="Search-Grid"><i class="fe fe-search header-link-icon fs-18"></i></a>
                    <input type="search" class="form-control border-0 px-2" placeholder="Search" aria-label="Username">
                    <a href="javascript:void(0);" class="input-group-text" id="voice-search"><i class="fe fe-mic header-link-icon"></i></a>
                    <a href="javascript:void(0);" class="btn btn-light btn-icon" data-bs-toggle="dropdown" aria-expanded="false">
                      <i class="fe fe-more-vertical"></i>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="javascript:void(0);">Action</a></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Another action</a></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Something else here</a></li>
                      <li><hr class="dropdown-divider"></li>
                      <li><a class="dropdown-item" href="javascript:void(0);">Separated link</a></li>
                    </ul>
                  </div>
                  <div class="mt-4">
                    <p class="font-weight-semibold text-muted mb-2">Are You Looking For...</p>
                    <span class="search-tags alert"><i class="fe fe-user me-2"></i>People<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-file-text me-2"></i>Pages<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-align-left me-2"></i>Articles<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                    <span class="search-tags alert"><i class="fe fe-server me-2"></i>Tags<a href="javascript:void(0)" class="tag-addon" data-bs-dismiss="alert"><i class="fe fe-x"></i></a></span>
                  </div>
                  <div class="my-4">
                    <p class="font-weight-semibold text-muted mb-2">Recent Search :</p>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-2 alert">
                      <a href="notifications.html"><span>Notifications</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-2 alert">
                      <a href="alerts.html"><span>Alerts</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                    <div class="p-2 border br-5 d-flex align-items-center text-muted mb-0 alert">
                      <a href="mail.html"><span>Mail</span></a>
                      <a class="ms-auto lh-1" href="javascript:void(0);" data-bs-dismiss="alert" aria-label="Close"><i class="fe fe-x text-muted"></i></a>
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <div class="btn-group ms-auto">
                    <button type="button" class="btn btn-sm btn-primary-light">Search</button>
                    <button type="button" class="btn btn-sm btn-primary">Clear Recents</button>
                  </div>
                </div>
              </div>
            </div>
        </div>




	<!-- Popper JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/@popperjs/core/umd/popper.min.js"></script>

	<!-- Bootstrap JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>

	<!-- Defaultmenu JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/defaultmenu.min.js"></script>

	<!-- Node Waves JS-->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/node-waves/waves.min.js"></script>

	<!-- Sticky JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/sticky.js"></script>

	<!-- Simplebar JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/simplebar/simplebar.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/simplebar.js"></script>

	<!-- Color Picker JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/@simonwep/pickr/pickr.es5.min.js"></script>



	<!-- Custom-Switcher JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/custom-switcher.min.js"></script>

	<!-- Prism JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/prismjs/prism.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/prism-custom.js"></script>

	<!-- Filepond JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond/filepond.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-preview/filepond-plugin-image-preview.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-exif-orientation/filepond-plugin-image-exif-orientation.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-file-validate-size/filepond-plugin-file-validate-size.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-file-encode/filepond-plugin-file-encode.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-edit/filepond-plugin-image-edit.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-file-validate-type/filepond-plugin-file-validate-type.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-file-validate-type/filepond-plugin-file-validate-type.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-crop/filepond-plugin-image-crop.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-resize/filepond-plugin-image-resize.min.js"></script>
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/filepond-plugin-image-transform/filepond-plugin-image-transform.min.js"></script>


	<!-- Dropzone JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/dropzone/dropzone-min.js"></script>

	<!-- Fileupload JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/fileupload.js"></script>

	<!-- Custom JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/custom.js"></script>


	<!-- JSVector Maps JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/jsvectormap/js/jsvectormap.min.js"></script>

	<!-- JSVector Maps MapsJS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/libs/jsvectormap/maps/world-merc.js"></script>



	<!-- CRM-Dashboard -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/crm-dashboard.js"></script>
	
    <script src="${pageContext.request.contextPath }/resources/assets/libs/flatpickr/flatpickr.min.js"></script>


	<!-- Custom-Switcher JS -->
	<script
		src="${pageContext.request.contextPath }/resources/assets/js/custom-switcher.min.js"></script>

    <script src="${pageContext.request.contextPath }/resources/assets/libs/dragula/dragula.min.js"></script>
       <!-- Internal Task  JS -->
       <script src="${pageContext.request.contextPath }/resources/assets/js/task-kanban-board.js"></script>
    
    <!-- Select2 Cdn -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- Internal Select-2.js -->
    <script src="${pageContext.request.contextPath }/resources/assets/js/select2.js"></script>
    
    
</body>
<script type="text/javascript">
$(function(){

	//진단 및 처방 검색 오토커밋
	let arr=[];
	var searchFlag=true;
	if(searchFlag){
	     $.ajax({
	            type : 'GET',
	            
	            url: '/doctor/diseaseSearch',
	            dataType : 'json',
	            success : function(data) {
	                // 서버에서 json 데이터 response 후 목록 추가
	                	for(var i=0 ; i<data.length; i++){
	                		arr[i]= data[i].disNo + " " + data[i].disNameKr;
	                	}
	            }
     	});
	}
	
	  //상병검색
	  var diseaseTab = document.querySelector('a[href="#searchDiseases"]');
	  diseaseTab.addEventListener('click', function (event) {
		searchFlag=true;
		$('#searchBox').val('');	
        $.ajax({
	            type : 'GET',
	            url: '/doctor/diseaseSearch',
	            dataType : 'json',
	            success : function(data) {
	                // 서버에서 json 데이터 response 후 목록 추가
	                	for(var i=0 ; i<data.length; i++){
	                		arr[i]= data[i].disNo + " " + data[i].disNameKr;
	                	}
	            }
        	});
		});
	 //약물검색
	
	 var medicineTab = document.querySelector('a[href="#searchMedicine"]');
	 medicineTab.addEventListener('click', function (event) {
		 searchFlag=false;
		 $('#searchBox').val('');
	        $.ajax({
		            type : 'GET',
		            url: '/doctor/medicineSearch',
		            dataType : 'json',
		            success : function(data) {
		                // 서버에서 json 데이터 response 후 목록 추가
		                	for(var i=0 ; i<data.length; i++){
		                		arr[i]=data[i].mdcinNo + " " + data[i].mdcinName;
		                	}
		            }
	        	});
			});
// 		var medicineList = [];	//처방약 리스트 배열
		var medicineSelect="";	//
	 	var medicineData ={};	//처방약을 제이슨형식으로 담은 데이터
	 	var medicineName="";	//처방약 이름 밸류값
	 	var medicineNo="";		//처방약 번호 키값
	 	var medicinePrescription = $('#medicinePrescription');
	 	
	 	var primaryDisease="";
	 	var primaryDiseaseData ={};	//주상병을 제이슨형식으로 담은 데이터
	 	var primaryDiseaseName="";		//주상병 이름 밸류값
	 	var primaryDiseaseNo="";		//주상병 번호 키값
	 	var primaryDiseaseArea = $('#primaryDisease');	//주상병 텍스트 입력 영역
	 	
	 	var secondaryDisease="";
		var secondaryDiseaseList = [];	//부상병 리스트 배열
	 	var secondaryDiseaseNoList=[];	//부상병 번호 배열
	 	var secondaryDiseaseData ={};	//부상병을 제이슨형식으로 담은 데이터
	 	var secondaryDiseaseName="";		//부상병 이름 밸류값
	 	var secondaryDiseaseNo="";		//부상병 번호 키값
	 	var secondaryDiseaseArea = $('#secondDisease');	//부상병 텍스트 입력 영역

	 	
	    $("#searchBox").autocomplete({
	    	maxShowItems: 5,
	       	source : arr,
	        select : function(event, ui) {	//검색 리스트에서 해당 필드 선택시 select 이벤트 발생
// 	            console.log(ui);
// 	            console.log(ui.item.label);
// 	            console.log(ui.item.value);
// 	            console.log(ui.item.test);

         	 
	            if (diseaseTab.classList.contains('active')) {

	            	//주상병 영역이 비어있을때 
		    	 	if (primaryDiseaseArea.next().length === 0){	
	            		var primaryDiseaseAreaHtml = "";	//주상병 입력 텍스트
	            		primaryDisease=ui.item.label;
	            		primaryDiseaseAreaHtml +="<div class='card custom-card m-2' style='display: inline-block; width:100%;'>"+primaryDisease+"<a href='#' id='deleteSel' style='display: inline-block; float: right; margin-right:10px;'>X</a></div>";
		            	primaryDiseaseArea.after(primaryDiseaseAreaHtml);
		            	
		            	$('#searchBox').val('');
		            	
	            	}else{									//부상병 영역에 추가
		            	var secondaryDiseaseAreaHtml ="";	//부상병입력 텍스트
		            	secondaryDisease = ui.item.label;	//부상병 입력
	            		secondaryDiseaseAreaHtml +="<div class='card custom-card m-2' style='display: inline-block; width:100%;'>"+secondaryDisease+"<a href='#' id='deleteSel' style='display: inline-block; float: right; margin-right:10px;'>X</a></div>";
	            		secondaryDiseaseArea.after(secondaryDiseaseAreaHtml);
	            		$('#searchBox').val('');
	            	}
		            
	            }else if(medicineTab.classList.contains('active')){
	            	var medicineAreaHtml = "";
	            	medicineSelect=ui.item.label;
					medicineAreaHtml +="<div class='card custom-card m-2' style='display: inline-block; width:100%;'>"+medicineSelect+"<a href='#' id='deleteSel' style='display: inline-block; float: right; margin-right:10px;'>X</a></div>";
	            	medicinePrescription.after(medicineAreaHtml);
					$('#searchBox').val('');
	            }
	        },
	        focus : function(event, ui) {	//한글 오류 방지
	            return false;
	        },
	        minLength : 1,
	        autoFocus : true,
	        classes : {
	            'ui-autocomplete': 'highlight'
	        },
	        delay : 500,
	        position : { my : 'right top', at : 'right bottom' },
	        close : function(event) {
	            console.log(event);
	        }
	  });
	 	
		//선택항목 삭제
		
		document.addEventListener('click', function(event) {
		    if (event.target.id === 'deleteSel') {
		        event.preventDefault(); // 기본 동작 방지
		        console.log("삭제!!!!!!");
		        var parentDiv = event.target.closest('.card'); // 클릭된 "X" 버튼의 부모 요소인 div.card를 찾습니다.
		        parentDiv.remove(); // 부모 요소를 삭제합니다.
		    }
		});
		
		//오더세트 등록
		var groupOrderName = ""; 	//오더세트 명
		$("#createOrderName").on("click", function(){
			groupOrderName= $("#orderName").val(); //그룹오더 이름
			
			//진단내역 테이블
			//주상병
			var primaryDiseaseSend = $("#primaryDisease").next("div").text().trim();	//주상병 번호와 이름
			primaryDiseaseName = primaryDiseaseSend.substring(primaryDiseaseSend.indexOf(' ')+1); // 주상병 이름
			primaryDiseaseNo = primaryDiseaseSend.substring(0, primaryDiseaseSend.indexOf(' ')); // 주상병 번호
		    primaryDiseaseData[primaryDiseaseNo]=primaryDiseaseName;	// JSON 형식의 데이터에 키와 값을 추가
			//부상병
			var secondaryDiseaseSend = [];
		    var secondaryDiseaseSel="";
			var divCountDisease = $("#secondDisease").siblings("div").length;
		    
		    for(var i=0; i<divCountDisease; i++){
		    	secondaryDiseaseSel = $("#secondDisease").nextAll("div").eq(i).text().trim()
				secondaryDiseaseSend.push(secondaryDiseaseSel);	//부상병 번호와 이름
				secondaryDiseaseName = secondaryDiseaseSel.substring(secondaryDiseaseSel.indexOf(' ')+1); // 부상병 이름
				secondaryDiseaseNo = secondaryDiseaseSel.substring(0, secondaryDiseaseSel.indexOf(' ')); // 부상병 번호
		 		secondaryDiseaseNoList.push(secondaryDiseaseNo); //부상병번호 배열형식(오더세트등록에서 쓰임)
		 		secondaryDiseaseData[secondaryDiseaseNo]=secondaryDiseaseName;  // JSON 형식의 데이터에 키와 값을 추가
		    }
			
			//오더테이블
			//처방약오더
			var medicineSend=[];
			
		    var medicineSel="";
			var divCountMedicine = $("#medicinePrescription").siblings("div").length;
			var medicineNoList=[];
		    
		    for(var i=0; i<divCountMedicine; i++){
		    	medicineSel = $("#medicinePrescription").nextAll("div").eq(i).text().trim()
				medicineSend.push(medicineSel);	//부상병 번호와 이름
					medicineName = medicineSel.substring(medicineSel.indexOf(' ')+1); // 부상병 이름
					medicineNo = medicineSel.substring(0, medicineSel.indexOf(' ')); // 부상병 번호
					medicineNoList.push(medicineNo); //부상병번호 배열형식(오더세트등록에서 쓰임)
		 		medicineData[medicineNo]=medicineName;  // JSON 형식의 데이터에 키와 값을 추가
		    }
			
			var data = {
					groupOrderName : groupOrderName,
					primaryDiseaseNo : primaryDiseaseNo,	//주상병번호
					secondaryDiseaseNoList : secondaryDiseaseNoList,	//부상병번호 리스트
					medicineNoList : medicineNoList
			};
			
		 	$.ajax({
	   		 	url: '/doctor/insertGroupOrder', // 서버의 엔드포인트 URL을 여기에 입력
	   	        type: 'POST',
	   	     	contentType: 'application/json',
	   	        dataType: 'text', 
	   	     	data: JSON.stringify(data),
	   	     	beforeSend: function(xhr) {
	   	     	   // CSRF 토큰 헤더에 추가
	                xhr.setRequestHeader($("meta[name='_csrf_header']").attr("content"), $("meta[name='_csrf']").attr("content"));
	     		},
	   	        success: function(res) {
	   				alert("성공!");
	   				$("#closeModal").click();
	   	        }
	   		});
		});
		
		$("#addOrderSet").on("click", function(){
			
			//영역을 다 비우는 이벤트 발생
			
		});
	//오더세트 조회
	var dropdownItems = document.querySelectorAll('.dropdown-item');
	// 각각의 요소에 대해 클릭 이벤트를 추가
	dropdownItems.forEach(function(item) {
	    item.addEventListener('click', function(event) {
	        event.preventDefault(); // 기본 동작 방지

	        // 클릭된 요소에서 그룹오더 넘버 가져오기
	        var groupOrderNo = this.getAttribute('data-groupOrderNo');
	        console.log("groupOrderNo:", groupOrderNo);
	        
		 	$.ajax({
	   		 	url: '/orderSet/detail', 
	   	        type: 'POST',
	   	     	contentType: 'application/json',
	   	        dataType: 'text', 
	   	     	data: JSON.stringify({groupOrderNo : groupOrderNo}),
	   	     	beforeSend: function(xhr) {
	             // CSRF 토큰 헤더에 추가
                    xhr.setRequestHeader($("meta[name='_csrf_header']").attr("content"), $("meta[name='_csrf']").attr("content"));
         		},

	   	        success: function(res) {
					console.log(res);
					
					
	   	        }
	   		});
	        
	    });
	});
	
	
	
});


</script>

</html>